<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Karishma AI — Living World</title>

<style>
/* ================= ROOT ================= */
:root{
  --accent:#ff5fa2;
  --skin:#f4e9e4;
  --hair:#2b1d1a;
  --glass:rgba(255,255,255,0.85);
  --shadow:0 15px 40px rgba(0,0,0,.25);
}

/* ================= GLOBAL ================= */
*{box-sizing:border-box}
body{
  margin:0;
  height:100vh;
  display:flex;
  background:#000;
  font-family:system-ui,-apple-system,Segoe UI,sans-serif;
  overflow:hidden;
}

/* ================= LAYOUT ================= */
#world{
  flex:1;
  position:relative;
  overflow:hidden;
  background:linear-gradient(#6db3f2,#ffffff 65%);
}
#chat{
  width:380px;
  background:var(--glass);
  backdrop-filter:blur(12px);
  display:flex;
  flex-direction:column;
  box-shadow:-10px 0 40px rgba(0,0,0,.3);
}
@media(max-width:850px){
  body{flex-direction:column}
  #world{height:60%}
  #chat{width:100%}
}

/* ================= SKY ================= */
.sun{
  position:absolute;
  width:80px;height:80px;
  border-radius:50%;
  background:radial-gradient(circle,#fff59d,#ff9800);
  box-shadow:0 0 80px #ff9800;
  top:12%;left:15%;
}

/* ================= LAND ================= */
.ground{
  position:absolute;
  bottom:0;
  height:30%;
  width:100%;
  background:linear-gradient(#6fbf73,#3f8f46);
}
.pond{
  position:absolute;
  bottom:10%;
  right:8%;
  width:220px;height:80px;
  background:radial-gradient(circle at top,#7fd3ff,#1976d2);
  border-radius:50%;
  box-shadow:inset 0 10px 20px rgba(255,255,255,.4);
}

/* ================= TREE ================= */
.tree{
  position:absolute;
  bottom:18%;
  left:6%;
  cursor:pointer;
}
.trunk{
  width:14px;height:90px;
  background:#4e342e;
  margin:auto;
  border-radius:4px;
}
.leaves{
  width:120px;height:120px;
  background:#2e7d32;
  border-radius:50%;
  position:absolute;
  bottom:70px;left:-53px;
  box-shadow:inset -10px -10px rgba(0,0,0,.15);
}

/* ================= HOUSE ================= */
.house{
  position:absolute;
  bottom:18%;
  left:16%;
  cursor:pointer;
}
.house-body{
  width:130px;height:95px;
  background:#fff3cd;
  border:2px solid #555;
}
.house-roof{
  width:0;height:0;
  border-left:75px solid transparent;
  border-right:75px solid transparent;
  border-bottom:55px solid #c62828;
  margin-left:-10px;
}

/* ================= SIGN ================= */
.sign{
  position:absolute;
  bottom:20%;
  right:40%;
  background:#3e2723;
  color:#fff;
  padding:6px 14px;
  border-radius:6px;
  font-size:12px;
}

/* ================= KARISHMA ================= */
#karishma{
  position:absolute;
  bottom:18%;
  left:50%;
  transform:translateX(-50%);
  cursor:pointer;
}

/* HEAD */
.head{
  width:110px;height:130px;
  background:var(--skin);
  border-radius:50% 50% 45% 45%;
  position:relative;
  box-shadow:var(--shadow);
}

/* HAIR */
.hair{
  position:absolute;
  top:-12px;
  width:100%;height:70px;
  background:var(--hair);
  border-radius:50% 50% 30% 30%;
}

/* EYES */
.eye{
  position:absolute;
  top:52px;
  width:18px;height:22px;
  background:#111;
  border-radius:50%;
}
.eye.left{left:30px}
.eye.right{right:30px}

/* BODY */
.body{
  width:100px;height:120px;
  background:#ffffff;
  margin:auto;
  margin-top:-12px;
  border-radius:22px;
  box-shadow:var(--shadow);
  display:flex;
  align-items:center;
  justify-content:center;
}
.core{
  width:22px;height:22px;
  background:var(--accent);
  border-radius:50%;
  box-shadow:0 0 12px var(--accent);
  animation:pulse 2s infinite;
}

@keyframes pulse{
  50%{transform:scale(1.2)}
}

/* ================= CHAT ================= */
.header{
  padding:14px;
  border-bottom:1px solid #ddd;
  font-weight:600;
}
.messages{
  flex:1;
  overflow-y:auto;
  padding:16px;
  display:flex;
  flex-direction:column;
  gap:10px;
}
.msg{
  max-width:80%;
  padding:10px 14px;
  border-radius:16px;
}
.user{align-self:flex-end;background:var(--accent);color:#fff}
.bot{align-self:flex-start;background:#fff;border:1px solid #ddd}

.input{
  display:flex;
  padding:12px;
  gap:8px;
}
.input input{
  flex:1;
  padding:10px;
  border-radius:20px;
  border:1px solid #ccc;
}
.input button{
  width:40px;height:40px;
  border-radius:50%;
  border:none;
  background:var(--accent);
  color:#fff;
}
</style>
</head>

<body>

<div id="world">
  <div class="sun"></div>
  <div class="ground"></div>
  <div class="pond" onclick="touchObject('pond')"></div>

  <div class="tree" onclick="touchObject('tree')">
    <div class="leaves"></div>
    <div class="trunk"></div>
  </div>

  <div class="house" onclick="touchObject('house')">
    <div class="house-roof"></div>
    <div class="house-body"></div>
  </div>

  <div class="sign">Created by Abhik Dutta</div>

  <div id="karishma">
    <div class="head" onclick="touchBody('head')">
      <div class="hair"></div>
      <div class="eye left"></div>
      <div class="eye right"></div>
    </div>
    <div class="body" onclick="touchBody('body')">
      <div class="core"></div>
    </div>
  </div>
</div>

<div id="chat">
  <div class="header">Karishma AI</div>
  <div class="messages" id="msgs"></div>
  <div class="input">
    <input id="text" placeholder="Talk to Karishma…">
    <button onclick="send()">➤</button>
  </div>
</div>

<script>
let API_KEY=localStorage.getItem("gemini_key_auto_detect");
let MODEL="gemini-1.5-flash";
let history=[];

const SYSTEM=
"You are Karishma AI, created by Abhik Dutta. You are a cute, human-like AI girl. Replies under 20 words, expressive, warm, slightly playful.";

function add(t,c){
  const d=document.createElement("div");
  d.className="msg "+c;
  d.innerText=t;
  msgs.appendChild(d);
  msgs.scrollTop=msgs.scrollHeight;
}

function send(){
  const v=text.value.trim();
  if(!v)return;
  add(v,"user");
  text.value="";
  callAI(v);
}

function touchObject(obj){
  callAI(`[TOUCH_OBJECT]: User touched ${obj}`,true);
}

function touchBody(part){
  callAI(`[TOUCH_BODY]: User touched your ${part}`,true);
}

async function callAI(text,hidden=false){
  if(!API_KEY){add("Please add Gemini API key.","bot");return;}
  const body={
    contents:[
      {role:"user",parts:[{text:SYSTEM}]},
      ...history,
      {role:"user",parts:[{text:text}]}
    ]
  };
  const r=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${MODEL}:generateContent?key=${API_KEY}`,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify(body)
  });
  const j=await r.json();
  const reply=j.candidates?.[0]?.content?.parts?.[0]?.text||"…";
  if(!hidden)add(reply,"bot");
  history.push({role:"user",parts:[{text}]});
  history.push({role:"model",parts:[{text:reply}]});
}
</script>

</body>
</html>
